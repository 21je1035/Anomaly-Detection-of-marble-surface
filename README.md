# Detection-of-defect-on-marble-surface

Project Description:

Robust Data Preprocessing and Augmentation:
Implemented comprehensive data preprocessing on 10,000+ images using OpenCV and Keras' ImageDataGenerator, including rescaling, zooming, flipping, and rotating, enhancing dataset diversity and model robustness.

High-Performance CNN Model Development:
Designed and trained a Convolutional Neural Network (CNN) with Keras, achieving 92% accuracy. The model architecture included convolutional, max-pooling, and dropout layers to prevent overfitting and ensure high performance.

Effective Integration and Model Deployment:
Streamlined the training and validation process using Google Colab and Drive, ensuring seamless integration and efficient data management. Successfully saved and deployed the model for real-time crack detection applications.

Below are the key components and steps involved in this project:

Dataset Used: https://www.kaggle.com/datasets/wardaddy24/marble-surface-anomaly-detection-2

1. Data Loading and Preprocessing:

 - Google Drive Integration: Mounted Google Drive to access the dataset stored in specific directories (train and test).
 - Image Preprocessing: Utilized OpenCV to read and display images. Implemented an image data generator for data augmentation, which included rescaling, zooming, shearing, flipping, rotating, and shifting 
   operations to enhance the dataset.
   
2. Data Augmentation:

 - Image Data Generator: Created training and validation generators using ImageDataGenerator from Keras to perform real-time data augmentation and generate batches of tensor image data with real-time data 
   augmentation.
   
3. Data Organization:

 - Dataframe Creation: Built a dataframe containing image paths and their corresponding labels. This facilitated easy access and manipulation of the dataset for training and validation.
   
4. Model Architecture:

 - CNN Model Design: Designed a Convolutional Neural Network (CNN) using Keras' Sequential API. The architecture included:
    - Convolutional layers with ReLU activation
    - MaxPooling layers
    - Dropout layers to prevent overfitting
    - Fully connected Dense layers
    - Output layer with softmax activation for multi-class classification
      
5. Model Compilation and Training:

 - Compilation: Compiled the model with Adam optimizer and categorical cross-entropy loss function. Implemented early stopping to monitor validation loss and prevent overfitting.
 - Training: Trained the model on the training dataset and validated it using the validation dataset. Plotted training and validation accuracy and loss curves to visualize the model's performance.

6. Model Evaluation and Visualization:

 - Prediction Visualization: Implemented functions to visualize a batch of augmented images and model predictions. Used matplotlib for plotting and OpenCV for image handling.
 - Performance Metrics: Evaluated model performance using accuracy metrics and confusion matrix. Visualized loss and accuracy curves to assess training progress.

7. Model Saving:

 - Model Serialization: Saved the trained model to Google Drive for future use and deployment.
 

- Key Functions and Components:
    - get_image(path): Reads and displays an image from a given path.
    - datapreprocessing(main_dir, bsize): Prepares and augments image data from the specified directory.
    - getdata(folder_path): Constructs a dataframe from image paths and labels.
    - visualize_gen(train_generator): Visualizes augmented images generated by the data generator.
    - imageclf2(input_shape): Builds the CNN model architecture.
    - compiler2(model, train_generator, valid_generator, epchs, bsize, lr): Compiles and trains the CNN model.
    - get_predictions(n): Generates predictions for a given image and visualizes the result.
    - get_n_images(n, df, label): Displays a specified number of images for a given label from the dataframe.

- Technologies and Libraries Used:
    - Python: For overall programming and scripting.
    - Keras and TensorFlow: For building and training the deep learning model.
    - OpenCV: For image processing.
    - Pandas: For data manipulation and organization.
    - Matplotlib: For visualizing images and plotting graphs.
    - Google Colab: For leveraging cloud resources and integrating with Google Drive.

  
This project demonstrates the application of deep learning for image classification, emphasizing data preprocessing, model design, training, and evaluation, making it a comprehensive solution for detecting cracks in images.
